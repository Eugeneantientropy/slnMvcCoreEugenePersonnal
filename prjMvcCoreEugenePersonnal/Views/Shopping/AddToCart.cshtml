@model prjMvcCoreEugenePersonnal.Models.Product
@{
    ViewBag.Title = "AddToCart";
}

@{
    var product = ViewBag.Product as prjMvcCoreEugenePersonnal.Models.Product;
}

<style>
    .product-image {
        width: 100%;
        max-height: 390px; /* 300px + 30% */
        object-fit: cover;
    }

    .thumbnail-image {
        width: 100%;
        max-height: 100px; /* or any specific height for small images */
        object-fit: cover;
    }
</style>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    <div class="container py-4">
        <div class="row">
            <div class="col-md-6 mb-4">
                @if (product != null)
                {
                    <input type="hidden" name="txtProductID" value="@product.ProductId" />
                    <div class="card">
                        <img id="mainImage" src="~/images/Product/@product.ProductImagePath" class="card-img-top img-fluid product-image" alt="@product.ProductName" />
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <img src="~/images/Product/@product.ProductImagePath" class="img-fluid rounded shadow-sm img-thumbnail thumbnail-image" alt="Product Image" onclick="changeMainImage(this.src)" style="cursor:pointer; transition: transform .2s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'" />
                                </div>
                                @if (ViewBag.ProdImgList != null)
                                {
                                    @foreach (var img in ViewBag.ProdImgList as List<ProductPhoto>)
                                    {
                                        <div class="col-md-4 mb-3">
                                            <img src="~/images/Product/Detail/@img.ProductUrl" class="img-fluid rounded shadow-sm img-thumbnail thumbnail-image" alt="Product Image" onclick="changeMainImage(this.src)" style="cursor:pointer; transition: transform .2s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'" />
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                }
                else
                {
                    <p class="text-danger">Product not found</p>
                }
            </div>
            <div class="col-md-6">
                @if (product != null)
                {
                    <div class="card-body">
                        <h1 class="card-title text-primary">@product.ProductName</h1>
                        <h4 class="card-text text-secondary">價錢: @product.Price</h4>
                        <h4 class="card-text text-secondary">風味描述: @product.Description</h4>
                        <h4 class="card-text text-secondary">單位: 半磅</h4>

                        <div class="form-group mt-3">
                            <label for="txtCount" class="h5">購買數量</label>
                            <select name="txtCount" class="form-control" style="width:60%;">
                                @for (var i = 1; i <= product.StockQuantity; i++)
                                {
                                    <option value="@i">@i</option>
                                }
                            </select>
                        </div>
                        <div class="form-group mt-3">
                            <input type="submit" value="加入購物車" class="btn btn-primary btn-lg" />
                            <button type="button" onclick="window.location.href='@Url.Action("List","Shopping")'" class="btn btn-danger btn-lg">取消</button>
                        </div>
                    </div>
                }
                else
                {
                    <div class="form-group mt-3">
                        <label for="txtCount" class="h5">購買數量</label>
                        @Html.TextBox("txtCount", "1", new { @class = "form-control", type = "number", min = "1" })
                    </div>
                    <div class="form-group mt-3">
                        <input type="submit" value="加入購物車" class="btn btn-primary btn-lg" />
                        <button type="button" onclick="window.location.href='@Url.Action("List","Shopping")'" class="btn btn-danger btn-lg">取消</button>
                    </div>
                }
            </div>
        </div>
    </div>
}

<script>
    function changeMainImage(src) {
        document.getElementById('mainImage').src = src;
    }
</script>

<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script src="~/Scripts/jquery.validate.min.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
